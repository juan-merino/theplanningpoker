import{d as X,r as y,u as Y,a as b,b as Z,c as ee,e as ne,f as a,g as f,h as i,i as o,w as d,j as oe,k as E,F as j,l as te,m as ie,n as p,o as se,p as l,q as s,s as V,t as $,v as B,x as ae,y as re,z as le}from"./index-CA4hLZ9q.js";const ce={class:"d-flex align-center justify-center"},de={style:{width:"600px"}},me={key:0},ue={key:1},pe={key:0},ve={key:0},fe={key:1,class:"pa-4"},_e={class:"d-flex align-center justify-space-evenly flex-wrap"},ke={key:2},ye={class:"d-flex align-center justify-space-between"},be={key:0},ge={key:0},xe={key:1},he={key:1},Ce={key:0},we={key:1},ze={key:1},Ee={key:1},Re=X({__name:"RoomView",setup(Ve){const _=localStorage.getItem("device"),v=ie().params.id,g=y(null),h=y(!1),P=y(""),x=y(!1),I=y(5e3),{data:m,pending:N,error:T}=Y(b(p,"theplanningpoker",v)),{data:c,pending:L,error:q}=Z(ee(p,"theplanningpoker",v,"participants"));let C=ne(()=>!m.value||!c.value?null:m.value.status==="hide"?c.value.slice().sort((n,e)=>n.name.localeCompare(e.name)):c.value.slice().sort((n,e)=>R(n.estimate)-R(e.estimate)));function R(n){return n?n==="?"?1:n==="0"?2:n==="1"?3:n==="2"?4:n==="3"?5:n==="5"?6:n==="8"?7:8:0}function F(n){return n?n==="?"?"mdi-help-box":n==="0"?"mdi-numeric-0-box":n==="1"?"mdi-numeric-1-box":n==="2"?"mdi-numeric-2-box":n==="3"?"mdi-numeric-3-box":n==="5"?"mdi-numeric-5-box":n==="8"?"mdi-numeric-8-box":"mdi-plus-box":"mdi-minus"}async function U(){h.value=!0;const n=b(p,"theplanningpoker",v,"participants",_);await re(n,{name:g.value,estimate:null}),h.value=!1}async function M(n){if(!n)return;const e=le(p),w=b(p,"theplanningpoker",v);e.update(w,{status:n==="hide"?"show":"hide"}),n==="show"&&c.value&&c.value.length&&c.value.forEach(r=>{if(r.estimate){const z=b(p,"theplanningpoker",v,"participants",r.id);e.update(z,{estimate:null})}}),await e.commit()}async function u(n){if(!n)return;const e=b(p,"theplanningpoker",v,"participants",_);await se(e,{estimate:n})}function O(n){navigator.clipboard.writeText(window.location.origin+"/"+n),P.value="¡Link copiado!",x.value=!0}function A(n,e){return n!=="hide"?"primary":"accent"}return(n,e)=>{const w=l("v-skeleton-loader"),r=l("v-btn"),z=l("v-toolbar"),G=l("v-card-title"),H=l("v-card-item"),D=l("v-card"),J=l("v-text-field"),k=l("v-icon"),K=l("v-card-text"),S=l("v-empty-state"),Q=l("v-snackbar");return s(),a(j,null,[f("main",null,[f("div",ce,[f("div",de,[i(N)||i(L)?(s(),a("div",me,[o(w,{type:"heading, ossein, subtitle"})])):(s(),a("div",ue,[!i(T)&&!i(q)?(s(),a("div",pe,[i(m)?(s(),a("div",ve,[o(D,null,{default:d(()=>[o(z,{color:"transparent"},{append:d(()=>[o(r,{size:"small",icon:"mdi-share-variant",onClick:e[0]||(e[0]=t=>O(i(m).id))}),o(r,{size:"small",icon:i(m).status==="hide"?"mdi-eye":"mdi-eye-off",onClick:e[1]||(e[1]=t=>M(i(m).status))},null,8,["icon"])]),_:1}),o(H,{class:"pt-0"},{default:d(()=>[o(G,null,{default:d(()=>[V($(i(m).name),1)]),_:1})]),_:1})]),_:1}),i(c)&&!i(c).some(t=>t.id===i(_))?(s(),a("form",{key:0,onSubmit:oe(U,["prevent"]),class:"mt-4"},[o(J,{modelValue:g.value,"onUpdate:modelValue":e[2]||(e[2]=t=>g.value=t),variant:"solo",label:"Ingresar como",clearable:""},{append:d(()=>[o(r,{type:"submit",color:"primary",icon:"mdi-plus",disabled:!g.value,loading:h.value},null,8,["disabled","loading"])]),_:1},8,["modelValue"])],32)):i(c)&&i(c).some(t=>t.id===i(_))?(s(),a("div",fe,[f("div",_e,[o(r,{color:"primary",size:"small",icon:"mdi-help-box",class:"btn-fs-1 ma-2",onClick:e[3]||(e[3]=t=>u("?"))}),o(r,{color:"primary",size:"small",icon:"mdi-numeric-0-box",class:"btn-fs-1 ma-2",onClick:e[4]||(e[4]=t=>u("0"))}),o(r,{color:"primary",size:"small",icon:"mdi-numeric-1-box",class:"btn-fs-1 ma-2",onClick:e[5]||(e[5]=t=>u("1"))}),o(r,{color:"primary",size:"small",icon:"mdi-numeric-2-box",class:"btn-fs-1 ma-2",onClick:e[6]||(e[6]=t=>u("2"))}),o(r,{color:"primary",size:"small",icon:"mdi-numeric-3-box",class:"btn-fs-1 ma-2",onClick:e[7]||(e[7]=t=>u("3"))}),o(r,{color:"primary",size:"small",icon:"mdi-numeric-5-box",class:"btn-fs-1 ma-2",onClick:e[8]||(e[8]=t=>u("5"))}),o(r,{color:"primary",size:"small",icon:"mdi-numeric-8-box",class:"btn-fs-1 ma-2",onClick:e[9]||(e[9]=t=>u("8"))}),o(r,{color:"primary",size:"small",icon:"mdi-plus-box",class:"btn-fs-1 ma-2",onClick:e[10]||(e[10]=t=>u("8+"))})])])):E("",!0),i(C)&&i(C).length?(s(),a("div",ke,[(s(!0),a(j,null,te(i(C),(t,W)=>(s(),B(D,{key:t.id,class:ae({"mt-4":W>0})},{default:d(()=>[o(K,null,{default:d(()=>[f("div",ye,[f("span",null,[t.id===i(_)?(s(),B(k,{key:0,color:"primary",size:"extrasmall",icon:"mdi-check-decagram"})):E("",!0),V(" "+$(t.name),1)]),o(r,{icon:"",size:"small",class:"btn-fs-1",color:A(i(m).status,t.estimate)},{default:d(()=>[i(m).status==="hide"?(s(),a("span",be,[t.estimate?(s(),a("span",xe,[o(k,{icon:"mdi-message-check"})])):(s(),a("span",ge,[o(k,{icon:"mdi-message-processing"})]))])):(s(),a("span",he,[t.estimate?(s(),a("span",we,[o(k,{icon:F(t.estimate)},null,8,["icon"])])):(s(),a("span",Ce,[o(k,{icon:"mdi-minus"})]))]))]),_:2},1032,["color"])])]),_:2},1024)]),_:2},1032,["class"]))),128))])):E("",!0)])):(s(),a("div",ze,[o(S,{headline:"¡Error!",title:"Proyecto cerrado",text:"El proyecto al que intentas ingresar ha sido eliminado",icon:"mdi-alert-octagon",class:"my-16"})]))])):(s(),a("div",Ee,[o(S,{headline:"¡Error del servidor!",title:"Error de carga de datos",text:"Se produjo un error en el servidor mientras se cargaban los datos, por favor actualice la página",icon:"mdi-alert-octagon",class:"my-16"})]))]))])])]),o(Q,{modelValue:x.value,"onUpdate:modelValue":e[12]||(e[12]=t=>x.value=t),timeout:I.value},{actions:d(()=>[o(r,{icon:"mdi-close",onClick:e[11]||(e[11]=t=>x.value=!1)})]),default:d(()=>[V($(P.value)+" ",1)]),_:1},8,["modelValue","timeout"])],64)}}});export{Re as default};
